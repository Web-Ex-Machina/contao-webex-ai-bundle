{% extends "@Contao/be_main" %}
{% trans_default_domain 'WebExAiBundle' %}
{% block main_content %}
  <div class="space-y-8 bg-[#eaeaec] -m-px dark:bg-[#121416]">

    <div class="space-y-8">

      <div class="px-4 sm:flex sm:items-center">
        <div id="notification">
        </div>
        <div class="sm:flex-auto">
          <h2 class="text-base font-semibold text-neutral-900 dark:text-white dark:text-white">{{ "AiTools.parameters.title" | trans }}</h2>
        </div>
        <div class="mt-4 sm:mt-0 sm:ml-16 sm:flex-none">
        </div>
      </div>

      <div class="">
        <table class="min-w-full divide-y divide-slate-200 ">
          <thead class="bg-slate-50 ">
          <tr>
            <th scope="col" class="py-3.5 pr-3 pl-4 text-left text-sm font-semibold text-slate-900 sm:pl-6">{{ "AiTools.page.table.title" | trans }}</th>
            <th scope="col" class="w-1/2 py-3.5 pr-3 pl-4 text-left text-sm font-semibold text-slate-900 sm:pl-6">{{ "AiTools.page.table.description" | trans }}</th>
            <th scope="col" class="py-3.5 pr-3 pl-4 text-center text-sm font-semibold text-slate-900 sm:pl-6">{{ "AiTools.page.table.type" | trans }}</th>
            <th scope="col" class="py-3.5 pr-3 pl-4 text-right text-sm font-semibold text-slate-900 sm:pl-6">{{ "AiTools.page.table.actions" | trans }}</th>
          </tr>
          </thead>
          <tbody class="divide-y divide-slate-200 bg-white">
          {% for item in pages %}
          <tr class="even:bg-slate-50" data-id="{{item.id}}" data-type="{{item.type}}">
            <td class="py-2 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-slate-900 sm:pl-3">
              <div class="flex items-center gap-2 justify-items-stretch">
                <input class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-slate-900 outline-1 -outline-offset-1 outline-slate-300 placeholder:text-slate-400 focus:outline-2 focus:-outline-offset-2 focus:outline-sky-600 sm:text-sm/6" id="title-{{item.id}}" value="{{item.title}}" />
                <button id="button-title-{{item.id}}" disabled class="disabled:border-slate-200 disabled:bg-slate-50 disabled:text-slate-500 disabled:shadow-none relative inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-[#2271b1] ring-1 ring-slate-300 ring-inset hover:bg-slate-50 focus:z-10" data-save-id-title="{{item.id}}">
                  {{ "AiTools.page.ai.save" | trans }}
                </button>
              </div>
            </td>
            <td class="px-3 py-2 text-sm whitespace-nowrap text-slate-500">
              <div class="flex items-center gap-2 justify-items-stretch">

                <input class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-slate-900 outline-1 -outline-offset-1 outline-slate-300 placeholder:text-slate-400 focus:outline-2 focus:-outline-offset-2 focus:outline-sky-600 sm:text-sm/6" id="description-{{item.id}}" value="{% if item.description is defined %}{{item.description}}{% endif %}" />
                <button id="button-description-{{item.id}}" disabled class="disabled:border-slate-200 disabled:bg-slate-50 disabled:text-slate-500 disabled:shadow-none relative inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-[#2271b1] ring-1 ring-slate-300 ring-inset hover:bg-slate-50 focus:z-10" data-save-id-description="{{item.id}}">
                  {{ "AiTools.page.ai.save" | trans }}
                </button>

              </div>
            </td>
            <td class="px-3 py-2 text-sm whitespace-nowrap text-slate-500 text-center">
              {{"PTY.regular.0" |trans({},'contao_default') }}
            </td>
            <td class="py-2 pr-4 pl-3 text-sm whitespace-nowrap text-slate-500 space-x-3 text-right">
              <span class="isolate inline-flex rounded-md shadow-xs">
                  <button data-id="{{item.id}}" data-title="{{item.title}}" class="ia-get-title disabled:border-slate-200 disabled:bg-slate-50 disabled:text-slate-500 disabled:shadow-none relative inline-flex items-center rounded-l-md bg-white px-3 py-2 text-sm font-bold text-[#2271b1] ring-1 ring-slate-300 ring-inset hover:bg-slate-50 focus:z-10">{{ "AiTools.page.ai.get_title" | trans }}</button>
                  <button data-id="{{item.id}}" data-description="{% if item.description is defined %}{{item.description}}{% endif %}" class="ia-get-description disabled:border-slate-200 disabled:bg-slate-50 disabled:text-slate-500 disabled:shadow-none relative -ml-px inline-flex rounded-r-md items-center bg-white px-3 py-2 text-sm font-bold text-[#2271b1] ring-1 ring-slate-300 ring-inset hover:bg-slate-50 focus:z-10">{{ "AiTools.page.ai.get_description" | trans }}</button>
              </span>
              <span class="isolate inline-flex rounded-md shadow-xs">
                  <a href="" target="_blank" class="relative -ml-px inline-flex items-center rounded-l-md bg-white px-3 py-2 text-sm font-bold text-blue-900 ring-1 ring-slate-300 ring-inset hover:bg-slate-50 focus:z-10">{{ "AiTools.page.view" | trans }}</a>
                  <a href="" target="_blank" class="relative -ml-px inline-flex items-center rounded-r-md bg-white px-3 py-2 text-sm font-bold text-blue-900 ring-1 ring-slate-300 ring-inset hover:bg-slate-50 focus:z-10">{{ "AiTools.page.edit" | trans }}</a>
              </span>
            </td>
          </tr>
          {% endfor %}
          </tbody>
        </table>

      </div>
    </div>
  </div>

  <script>
      // document.addEventListener("DOMContentLoaded", function() {
      //
      //
      //     var baseUrl = window.location.toString()+"&TL_AJAX=1&rt="+rt; // il faut le TL_AJAX + rt pour que Contao soit content
      //
      //
      //     async function getMergeDetails(){
      //
      //         const button = $(this);
      //         const postId = button.data('id');
      //
      //         // Disable button and show loading state
      //         button.prop('disabled', true).text('Optimizing...');
      //
      //         return new Promise(function (resolve, reject) {
      //             fetch(baseUrl+"&action=getMergeDetails&certificate_a_id="+certificate_a+"&certificate_b_id="+certificate_b,{
      //                 method:'get',
      //             })
      //             .then(response => response.json())
      //             .then(r => {
      //                 if("error" === r.status) {
      //                     reject(r.msg);
      //                 } else {
      //                     resolve(r);
      //                 }
      //             })
      //             .catch(error => {
      //                 reject(error);
      //             });
      //         });
      //     }
      //
      //     const button = document.querySelector('.ia-get-title');
      //     button.addEventListener('click',getMergeDetails);
      //
      //
      // });
  </script>
{% endblock %}